# i18n CLI

多语言翻译工具，实现 **自动翻译 + 翻译复用 + 校对闭环**，降低多语言维护成本。

---

## 核心能力

- **自动翻译**：新增/修改文案自动生成目标语言内容
- **增量更新**：仅翻译新增或修改文案，保证文案的一致性
- **校对闭环**：修数据 + 运行导出（i18n.db.json → i18n run → 各语言包）
- **多语言支持**：支持任意目标语言，可扩展术语表(无需翻译的术语)，词汇表(特定翻译的术语)
- **大模型支持**：支持任意OpenAI兼容大模型

---

## 快速使用

### 安装

```bash
pnpm install -g i18n-cli
```

### 初始化

```bash
i18n init
```

生成 `i18n.config.json`，可配置主语言、目标语言和翻译服务。

### 自动翻译

```bash
i18n run
```

- 解析主语言包
- 对比缓存
- 生成或复用翻译
- 输出目标语言包（如 `zh-CN.json`、`es.json`）

### 校验语言包

```bash
i18n check
```

- 检查文案条数是否一致
- 确认每条主语言文案都有译文

---

## 数据文件示例

`i18n.db.json` 保存原文、翻译， 作为语言包：

```json
{
  "sourceLang": "en-US",
  "entries": {
    "key1": { "en-US": "Log in", "zh-CN": "登录", "last_update": "2025-09-16T16:28:00Z" }
  }
}
```

---

## 核心命令

| 命令         | 功能              |
| ------------ | ----------------- |
| `i18n init`  | 初始化配置        |
| `i18n run`   | 翻译 & 导出语言包 |
| `i18n check` | 校验语言包完整性  |

---

## 使用流程

1. 开发新增文案 → 执行 `i18n run`
2. 校对修改 `i18n.db.json`
3. 再次执行 `i18n run` → 更新语言包

## 支持语言

完整列表查看：`src/constants/languages.ts`

```ts
/**
 * 支持的语言列表, 主要用于构建 prompt
 *
 * config.source_lang & config.target_langs 中的语言代码必须在此列表中有对应项
 *
 * key: 语言代码，可使用 iso 639 1 标准，如： en, zh, fr 等。如需支持其它格式语言代码（如 IETF BCP 47），可补充相关映射，如： zh-CN, zh-TW, pt-BR 等
 * value: 语言名称（中文 + 该语言自称）- 非严格规范，主要用于大模型理解目标语言。
 */
export const languages = {
  zh: '简体中文',
  'zh-CN': '简体中文',
  'zh-TW': '繁体中文-台湾 (繁體中文-台湾)',
  en: '英语 (English)',
  'en-US': '英语 (English)',
  es: '西班牙语 (Español)',
  fr: '法语 (Français)',
  ru: '俄语 (Русский)',
  pt: '葡萄牙语 (Português)',
};
```

---

## 实现功能

- [x] 不会重复翻译未变化内容
- [x] 增量翻译新增内容
- [x] 主动修改译文后(修改 db)，可以导出正确的语言包
- [x] 修改主语言文案，重新同步，译文会更新
- [x] 修改主语言 key，语言包可以正确更新
- [x] 支持压缩 key：使用数字替换，更稳定 & 节约 token （会丢失掉 key 部分的上下文）
- [x] 支持专业术语-无需翻译的术语、特定用法
- [x] 支持固定翻译-自定义某些词语的翻译，以便更贴合业务场景
- [x] 语言包校对：文案条目数量一致
- [x] 语言包校对：每条文案都有对应的译文
- [x] 将提示词迁移至配置文件
